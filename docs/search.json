[{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2020 Sean Davis Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Unlocking single cell spatial omics analyses with scdney","text":"Understanding interplay different types cells immediate environment critical understanding mechanisms cells function context human diseases. Recent advances high dimensional situ cytometry technologies fundamentally revolutionized ability observe complex cellular relationships providing unprecedented characterisation cellular heterogeneity tissue environment.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"description","dir":"Articles","previous_headings":"Overview","what":"Description","title":"Unlocking single cell spatial omics analyses with scdney","text":"workshop introduce key analytical concepts needed analyse data high dimensional spatial omics technologies , PhenoCycler, IMC, Xenium MERFISH. show functionality Bioconductor packages simpleSeg, FuseSOM, scClassify, scHot, spicyR, listClust, statial, scFeatures ClassifyR can used address various biological hypotheses. end workshop attendees able implement assess key steps spatial analysis pipeline including cell segmentation, feature normalisation, cell type identification, microenvironment cell-state characterisation, spatial hypothesis testing patient classification. Understanding key steps provide attendees core skills needed interrogate comprehensive spatial information generated exciting new technologies.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"pre-requisites","dir":"Articles","previous_headings":"Overview","what":"Pre-requisites","title":"Unlocking single cell spatial omics analyses with scdney","text":"expected students : basic knowledge R syntax, workshop provide -depth description cell-resolution spatial omics technologies.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"r-bioconductor-packages-used","dir":"Articles","previous_headings":"Overview","what":"R / Bioconductor packages used","title":"Unlocking single cell spatial omics analyses with scdney","text":"Several single cell R packages used scdney package, information visit: https://sydneybiox.github.io/scdney/.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"learning-objectives","dir":"Articles","previous_headings":"Overview","what":"Learning objectives","title":"Unlocking single cell spatial omics analyses with scdney","text":"Understand visualise spatial omics datasets. Identify key biological questions can addressed technologies spatial analysis. Understand key analytical steps involved spatial omics analysis, perform steps using R. Evaluate performance data normalisation cell segmentation. Understand generate individual feature representations spatial omics data. Develop appreciation assess performance classification models. Perform disease outcome prediction using feature representation robust classification framework.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"context","dir":"Articles","previous_headings":"","what":"Context","title":"Unlocking single cell spatial omics analyses with scdney","text":"following re-analyse IMC data (Ferguson et al, 2022) profiling spatial landscape head neck cutaneous squamous cell carcinomas (HNcSCC), second common type skin cancer. majority HNcSCC can treated surgery good local control, subset large tumours infiltrate subcutaneous tissue considered high risk local recurrence metastases. key conclusion manuscript (amongst others) spatial information cells immune environment can used predict primary tumour progression metastases patients. use spicy workflow reach similar conclusion.","code":""},{"path":[]},{"path":[]},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"installation","dir":"Articles","previous_headings":"Context > Setup","what":"Installation","title":"Unlocking single cell spatial omics analyses with scdney","text":"Time code chunk run: 0 seconds","code":"if (!requireNamespace(\"BiocManager\", quietly = TRUE)) {     install.packages(\"BiocManager\") }  BiocManager::install(c( \"simpleSeg\", \"cytomapper\", \"scClassify\", \"scHOT\", \"FuseSOM\",\"glmnet\", \"spicyR\", \"lisaClust\",\"Statial\", \"scFeatures\", \"ClassifyR\", \"tidyverse\", \"scater\", \"SingleCellExperiment\", \"STexampleData\", \"SpatialDatasets\", \"tidySingleCellExperiment\", \"scuttle\", \"batchelor\"))"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"load-packages","dir":"Articles","previous_headings":"Context > Setup","what":"Load packages","title":"Unlocking single cell spatial omics analyses with scdney","text":"Time code chunk run: 7.67 seconds","code":"# packages from scdney library(scdneySpatialBiocAsia2024) library(SpatialDatasets) library(simpleSeg) library(FuseSOM) library(lisaClust) library(spicyR) library(Statial) library(ClassifyR)  # Other required packages library(tidySingleCellExperiment) library(tidyverse) library(SingleCellExperiment) library(cytomapper) library(scater) library(glmnet) library(knitr)  theme_set(theme_classic())  nCores <- 8  # Feel free to parallelise things if you have the cores to spare. BPPARAM <- simpleSeg:::generateBPParam(nCores) source(system.file(\"extdata\", \"utils.R\", package = \"scdneySpatialBiocAsia2024\")) options(\"restore_SingleCellExperiment_show\" = TRUE)"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"download-images","dir":"Articles","previous_headings":"Context > Setup","what":"Download images","title":"Unlocking single cell spatial omics analyses with scdney","text":"Feel free follow along section. Much segmentation pipeline computationally demanding, likely won’t able run Bioconductor Galaxy servers. Time code chunk run: 0 seconds Time code chunk run: 0 seconds Time code chunk run: 0 seconds","code":"# Reads images to cache in a directory specified by the pathToImages variable. pathToImages <- SpatialDatasets::Ferguson_Images() tmp <- tempfile() # Creates a temporary directory. unzip(pathToImages, exdir = tmp) # Unzips files to the temporary directory.  # Store images in a CytoImageList on_disk as h5 files to save memory. images <- cytomapper::loadImages(   tmp, # Read files from the temporary directory.   single_channel = TRUE,   on_disk = TRUE,   h5FilesPath = HDF5Array::getHDF5DumpDir(),   BPPARAM = BPPARAM )  mcols(images) <- S4Vectors::DataFrame(imageID = names(images)) # Clean channel names cn <- channelNames(images) # Read in channel names head(cn)  cn <- sub(\".*_\", \"\", cn) # Remove preceding letters cn <- sub(\".ome\", \"\", cn) # Remove the .ome head(cn)  channelNames(images) <- cn # Reassign channel names # Clean image names head(names(images))  nam <- sapply(strsplit(names(images), \"_\"), `[`, 3) head(nam)  names(images) <- nam # Reassigning image names mcols(images)[[\"imageID\"]] <- nam # Reassigning image names"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"simpleseg-segmentation","dir":"Articles","previous_headings":"Context","what":"SimpleSeg: Segmentation","title":"Unlocking single cell spatial omics analyses with scdney","text":"SimpleSeg Package","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"run-simpleseg","dir":"Articles","previous_headings":"Context > SimpleSeg: Segmentation","what":"Run simpleSeg","title":"Unlocking single cell spatial omics analyses with scdney","text":"images stored list CytoImageList can segmented simple call simpleSeg(). summarise, simpleSeg() R implementation simple segmentation technique traces nuclei using specified channel using nucleus dilates around traced nuclei specified amount using discSize. nucleus can traced using either one specified channel, using principal components channels correlated specified nuclear channel setting pca = TRUE. particular example , asked simpleSeg following: setting nucleus = c(\"HH3\"), ’ve asked simpleSeg trace nuclei signal images using HH3 channel. setting pca = TRUE, simpleSeg segments nuclei mask using principal component analysis channels using principal components aligned nuclei channel, case, HH3. setting cellBody = \"dilate\", simpleSeg uses dilation strategy segmentation, expanding nucleus specified discSize. setting discSize = 3, simpleSeg dilates nucleus 3 pixels. setting sizeSelection = 20, simpleSeg ensures cells size greater 20 pixels used. setting transform = \"sqrt\", simpleSeg square root transforms channels prior segmentation. setting tissue = c(\"panCK\", \"CD45\", \"HH3\"), specify tissue mask simpleSeg uses, filtering background noise outside tissue mask. important tumour cores, wand hence circular, ’d want ignore background noise happens outside tumour core. many parameters can specified simpleSeg (smooth, watershed, tolerance, ext), encourage user select best parameters suit biological context. Time code chunk run: 0 seconds","code":"masks <- simpleSeg(images,                    nucleus = c(\"HH3\"),                    pca = TRUE,                    cellBody = \"dilate\",                    discSize = 3,                    sizeSelection = 20,                    transform = \"sqrt\",                    tissue = c(\"panCK\", \"CD45\", \"HH3\"),                    cores = nCores                    )"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"visualise-outlines","dir":"Articles","previous_headings":"Context > SimpleSeg: Segmentation","what":"Visualise outlines","title":"Unlocking single cell spatial omics analyses with scdney","text":"plotPixels function cytomapper makes easy overlay mask top nucleus intensity marker see well segmentation process performed. can see segmentation appears performing reasonably. see -segmentation images, discSize key parameter simpleSeg() optimising size dilation disc segmenting nuclei. Time code chunk run: 0 seconds Time code chunk run: 0.02 seconds wish visualise multiple markers instead just HH3 marker see segmentation mask performs, can also done. , can see segmentation mask done good job capturing CD31 signal, perhaps good job capturing FXIIIA signal, often lies outside dilated nuclear mask. suggest might need increase discSize dilation. Time code chunk run: 0 seconds Time code chunk run: 0.01 seconds Questions information ’re capturing segmentation? parameters might change improve segmentation? intrinsic limitations simpleSeg method? order characterise phenotypes segmented cells, measureObjects() cytomapper calculate average intensity channel within cell well morphological features. default, measureObjects() function return SingleCellExperiment object, channel intensities stored counts assay spatial location cell stored colData m.cx m.cy columns. However, can also specify measureObjects() return SpatialExperiment object specifying return_as = \"spe\". SpatialExperiment object, spatial location cell stored spatialCoords slot, m.cx m.cy, simplifies plotting. demonstration, return SpatialExperiment object. Time code chunk run: 0 seconds Next, associate features image disease progression, important read information links image identifiers progression status. , making sure imageID column matches. Time code chunk run: 0 seconds","code":"plotPixels(image = images[\"F3\"],             mask = masks[\"F3\"],            img_id = \"imageID\",             colour_by = c(\"HH3\"),             display = \"single\",            colour = list(HH3 = c(\"black\",\"blue\")),            legend = NULL,            bcg = list(              HH3 = c(1, 1, 2)            )) plotPixels(image = images[\"F3\"],             mask = masks[\"F3\"],            img_id = \"imageID\",             colour_by = c(\"HH3\", \"CD31\", \"FX111A\"),             display = \"single\",            colour = list(HH3 = c(\"black\",\"blue\"),                          CD31 = c(\"black\", \"red\"),                          FX111A = c(\"black\", \"green\") ),            legend = NULL,            bcg = list(              HH3 = c(1, 1, 2),              CD31 = c(0, 1, 2),              FX111A = c(0, 1, 1.5)            )) # Summarise the expression of each marker in each cell cells <- cytomapper::measureObjects(masks,                                     images,                                     img_id = \"imageID\",                                     return_as = \"spe\",                                     BPPARAM = BPPARAM)  spatialCoordsNames(cells) <- c(\"x\", \"y\") clinical <- read.csv(   system.file(     \"extdata/clinicalData_TMA1_2021_AF.csv\",     package = \"scdneySpatialBiocAsia2024\"   ) )  rownames(clinical) <- clinical$imageID clinical <- clinical[names(images), ]  colData(cells) <- cbind(colData(cells), clinical[cells$imageID, ])"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"simpleseg-normalisation","dir":"Articles","previous_headings":"Context","what":"simpleSeg: Normalisation","title":"Unlocking single cell spatial omics analyses with scdney","text":"’ve made easy follow normalisation section. SpatialDatasets package segmented SCE file stored function spe_Ferguson_2022(). Time code chunk run: 9.99 seconds","code":"#Download data now cells = SpatialDatasets::spe_Ferguson_2022()  cells$x = spatialCoords(cells)[, \"x\"] cells$y = spatialCoords(cells)[, \"y\"]"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"normalise-the-data","dir":"Articles","previous_headings":"Context > simpleSeg: Normalisation","what":"Normalise the data","title":"Unlocking single cell spatial omics analyses with scdney","text":"check see marker intensities cell require form transformation normalisation. reason two-fold: 1) intensities images often highly skewed, preventing meaningful downstream analysis. 2) intensities across different images often different, meaning considered “positive” can different across images. transforming normalising data, aim reduce two effects. extract intensities counts assay. Looking CD3 expressed majority T cells, intensities clearly skewed, difficult see considered CD3- cell, CD3+ cell. Time code chunk run: 1.26 seconds Questions Can see CD3+ vs CD3- cell ?","code":"# Plot densities of CD3 for each image. cells |>    join_features(features = rownames(cells), shape = \"wide\", assay = \"counts\") |>    ggplot(aes(x = CD3, colour = imageID)) +    geom_density() +    theme(legend.position = \"none\")"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"dimension-reduction-and-visualisation","dir":"Articles","previous_headings":"Context > simpleSeg: Normalisation","what":"Dimension reduction and visualisation","title":"Unlocking single cell spatial omics analyses with scdney","text":"data stored SpatialExperiment can also use scater perform visualise data lower dimension look batch effects images. can see normalisation, UMAP shows clear batch effect images. Time code chunk run: 41.35 seconds can transform normalise data using normalizeCells function. normalizeCells() function, specify following parameters. transformation optional argument specifies function applied data. apply arcsinh transformation , already apply square root transform simpleSeg() function. method = c(\"trim99\", \"mean\", PC1\") optional argument specifies normalisation method/s performed. , : 1) Trim 99th percentile 2) Divide mean 3) Remove 1st principal component assayIn = \"counts\" required argument specifies assay ’ll taking intensity data named. context, called counts. modified data stored norm assay default. can see normalised data appears bimodal, perfectly, likely sufficient degree clustering, can least observe clear CD3+ peak 1.00, CD3- peak around 0.3. Time code chunk run: 3.84 seconds Questions Can see CD3+ vs CD3- cell ? Time code chunk run: 41.28 seconds Questions hoping achieve normalisation? changed pre-normalisation post-normalisation correction UMAP?","code":"# Usually we specify a subset of the original markers which are informative to separating out distinct cell types for the UMAP and clustering. ct_markers <- c(\"podoplanin\", \"CD13\", \"CD31\",                 \"panCK\", \"CD3\", \"CD4\", \"CD8a\",                 \"CD20\", \"CD68\", \"CD16\", \"CD14\", \"HLADR\", \"CD66a\")  set.seed(51773) # Perform dimension reduction using UMAP. cells <- scater::runUMAP(   cells,   subset_row = ct_markers,   exprs_values = \"counts\" )  # Select a subset of images to plot. someImages <- unique(cells$imageID)[c(1, 5, 10, 20, 30, 40)]  # UMAP by imageID. scater::plotReducedDim(   cells[, cells$imageID %in% someImages],   dimred = \"UMAP\",   colour_by = \"imageID\" ) # Leave out the nuclei markers from our normalisation process.  useMarkers <- rownames(cells)[!rownames(cells) %in% c(\"DNA1\", \"DNA2\", \"HH3\")]  # Transform and normalise the marker expression of each cell type. cells <- simpleSeg::normalizeCells(cells,                         markers = useMarkers,                         transformation = NULL,                         method = c(\"trim99\", \"mean\", \"PC1\"),                         assayIn = \"counts\",                         cores = nCores )  # Plot densities of CD3 for each image cells |>    join_features(features = rownames(cells), shape = \"wide\", assay = \"norm\") |>    ggplot(aes(x = CD3, colour = imageID)) +    geom_density() +    theme(legend.position = \"none\") set.seed(51773) # Perform dimension reduction using UMAP. cells <- scater::runUMAP(   cells,   subset_row = ct_markers,   exprs_values = \"norm\",   name = \"normUMAP\" )  someImages <- unique(cells$imageID)[c(1, 5, 10, 20, 30, 40)]  # UMAP by imageID. scater::plotReducedDim(   cells[, cells$imageID %in% someImages],   dimred = \"normUMAP\",   colour_by = \"imageID\" )"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"fusesom","dir":"Articles","previous_headings":"Context","what":"FuseSOM","title":"Unlocking single cell spatial omics analyses with scdney","text":"FuseSOM Package FuseSOM Article dissect information cell interactions , cell-specific differences groups, next perform clustering. runFuseSOM() function FuseSOM package conveniently runs clustering SingleCellExperiment object, specifying number clusters numClusters. Time code chunk run: 2.04 seconds can also observe reasonable choice k = 10 , using estimateNumCluster() optiPlot() functions. examine Gap method, others Silhouette Within Cluster Distance also available. can see elbow points gap statistic k = 7, k = 10, k = 11. ’ve specified k = 10, striking good balance number clusters gap statistic. Time code chunk run: 0.67 seconds Questions choice k = 10 good choice? k might made sense? biological perspective, increasing k ?","code":"# Set seed. set.seed(51773)  # Generate SOM and cluster cells into 10 groups cells <- runFuseSOM(   cells,   markers = ct_markers,   assay = \"norm\",   numClusters = 10 ) cells <- estimateNumCluster(cells, kSeq = 2:30) optiPlot(cells, method = \"gap\")"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"attempt-to-interpret-the-phenotype-of-each-cluster","dir":"Articles","previous_headings":"Context > FuseSOM","what":"Attempt to interpret the phenotype of each cluster","title":"Unlocking single cell spatial omics analyses with scdney","text":"can begin process understanding cell clusters using plotGroupedHeatmap function scater. least, can see capture major immune populations expect see, including CD4 CD8 T cells, CD20+ B cells, CD68+ myeloid populations, CD66+ granulocytes, podoplanin+ epithelial cells, panCK+ tumour cells. Time code chunk run: 0.28 seconds Given domain-specific knowledge tumour-immune landscape, can go ahead annotate clusters cell types given expression profiles. Time code chunk run: 0.2 seconds might also interested cell types distributed images . examine distribution clusters image F3, noting healthy epithelial endothelial structures surrounded tumour cells. Time code chunk run: 0.35 seconds find always useful check number cells cluster. Time code chunk run: 0.01 seconds Questions distribution cell types make sense? normally expect expressed cell type least expressed cell type dataset? can also use UMAP computed earlier visualise data lower dimension see well annotated cell types cluster . Time code chunk run: 0.54 seconds","code":"# Visualise marker expression in each cluster. scater::plotGroupedHeatmap(   cells,   features = ct_markers,   group = \"clusters\",   exprs_values = \"norm\",   center = TRUE,   scale = TRUE,   zlim = c(-3, 3),   cluster_rows = FALSE,   block = \"clusters\" ) cells <- cells |>   mutate(cellType = case_when(     clusters == \"cluster_1\" ~ \"GC\", # Granulocytes     clusters == \"cluster_2\" ~ \"MC\", # Myeloid cells     clusters == \"cluster_3\" ~ \"SC\", # Squamous cells     clusters == \"cluster_4\" ~ \"EP\", # Epithelial cells     clusters == \"cluster_5\" ~ \"SC\", # Squamous cells     clusters == \"cluster_6\" ~ \"TC_CD4\", # CD4 T cells     clusters == \"cluster_7\" ~ \"BC\", # B cells     clusters == \"cluster_8\" ~ \"EC\", # Endothelial cells     clusters == \"cluster_9\" ~ \"TC_CD8\", # CD8 T cells     clusters == \"cluster_10\" ~ \"DC\" # Dendritic cells   )) reducedDim(cells, \"spatialCoords\") <- spatialCoords(cells)  cells |>    filter(imageID == \"F3\") |>    plotReducedDim(\"spatialCoords\", colour_by = \"cellType\") # Check cell type frequencies. cells$cellType |>   table() |>   sort() #>  #>     DC     BC     MC     GC TC_CD8 TC_CD4     EC     EP     SC  #>   2411   4322   5283   7993   8534  11753  14159  14170  87288 # UMAP by cell type scater::plotReducedDim(   cells[, cells$imageID %in% someImages],   dimred = \"normUMAP\",   colour_by = \"cellType\" )"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"spicyr-test-spatial-relationships","dir":"Articles","previous_headings":"Context","what":"spicyR: Test spatial relationships","title":"Unlocking single cell spatial omics analyses with scdney","text":"spicyR Package spicyR paper spicyR uses L-function determine localisation dispersion cell types. L-function measures attraction dispersion cell types, larger values (> 0) suggesting increased attraction, lower values (< 0) suggesting avoidance cell types. specify range radii calculate L-function set sigma = 50 account tissue inhomogeneity. Time code chunk run: 0 seconds Questions 1. L-function value 0 suggest? 2. choose optimal radii (Rs) given dataset? save time saved output code. Time code chunk run: 0.01 seconds can visualise tests using signifPlot function. Time code chunk run: 0.21 seconds Questions 1. cell types appear significant co-localistion/dispersion? 2. align might expect see biological context? spicyR also functionality plotting individual pairwise relationships. Time code chunk run: 0.1 seconds Alternatively, can look differentially localised relationship progressors non-progressors specifying rank = 1. Time code chunk run: 0.08 seconds","code":"spicyTest <- spicy(cells,                   condition = \"group\",                   cellTypeCol = \"cellType\",                   imageIDCol = \"imageID\",                   Rs = 1:10*10,                   sigma = 50,                   BPPARAM = BPPARAM) load(system.file(\"extdata\", \"spicyTest.rda\", package = \"scdneySpatialBiocAsia2024\")) topPairs(spicyTest, n = 10) #>             intercept coefficient    p.value adj.pvalue   from     to #> BC__EC     -1.1346644    8.304020 0.03391529  0.6931721     BC     EC #> EC__BC     -1.5909700    7.919971 0.04134661  0.6931721     EC     BC #> GC__TC_CD4 -7.6316673   11.005639 0.05047096  0.6931721     GC TC_CD4 #> TC_CD4__GC -7.5406782   11.077602 0.05709461  0.6931721 TC_CD4     GC #> TC_CD4__EP -0.7117393    4.853317 0.07261120  0.6931721 TC_CD4     EP #> EP__TC_CD4 -0.7070918    4.820661 0.07510118  0.6931721     EP TC_CD4 #> EP__TC_CD8 -3.1445464    5.779536 0.08047994  0.6931721     EP TC_CD8 #> TC_CD8__EP -2.9313474    5.688420 0.09522058  0.6931721 TC_CD8     EP #> TC_CD4__EC  3.1984391    4.366122 0.09716499  0.6931721 TC_CD4     EC #> EC__TC_CD4  3.1052061    4.263971 0.10461424  0.6931721     EC TC_CD4 # Visualise which relationships are changing the most. signifPlot(spicyTest,            fdr = TRUE) spicyBoxPlot(spicyTest,               from = \"BC\",               to = \"EC\") spicyBoxPlot(spicyTest,               rank = 1)"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"lisaclust-find-cellular-neighbourhoods","dir":"Articles","previous_headings":"Context","what":"lisaClust: Find cellular neighbourhoods","title":"Unlocking single cell spatial omics analyses with scdney","text":"lisaClust Package lisaClust paper lisaClust allows us identify regions spatial associations cell types similar. use lisaClust function clusters cells 5 regions distinct spatial ordering. Time code chunk run: 18.25 seconds save time results code saved can loaded .","code":"set.seed(51773)  cells <- lisaClust(   cells,   k = 5,   sigma = 50,   cellType = \"cellType\",   BPPARAM = BPPARAM )"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"region---cell-type-enrichment-heatmap","dir":"Articles","previous_headings":"Context > lisaClust: Find cellular neighbourhoods","what":"Region - cell type enrichment heatmap","title":"Unlocking single cell spatial omics analyses with scdney","text":"can interpret spatial orderings regions quantifying using regionMap function. plots frequency cell type region relative expect chance. Time code chunk run: 0.11 seconds","code":"# Visualise the enrichment of each cell type in each region regionMap(cells, cellType = \"cellType\", limit = c(0.2, 2))"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"visualise-regions","dir":"Articles","previous_headings":"Context > lisaClust: Find cellular neighbourhoods","what":"Visualise regions","title":"Unlocking single cell spatial omics analyses with scdney","text":"default, identified regions stored regions column colData SpatialExperiment object. can quickly examine spatial arrangement regions using ggplot image F3. Time code chunk run: 0.32 seconds much slower, hatchingPlot function can also used view regions co-localisation simultaneously cell type calls. Time code chunk run: 27.11 seconds Questions 1. choice k affect clustering results? 2. Looking graph , different value k better?","code":"cells |>    filter(imageID == \"F3\") |>    plotReducedDim(\"spatialCoords\", colour_by = \"region\") # Use hatching to visualise regions and cell types. hatchingPlot(   cells,   useImages = \"F3\",   cellType = \"cellType\",   nbp = 300 )"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"test-for-association-with-progression","dir":"Articles","previous_headings":"Context > lisaClust: Find cellular neighbourhoods","what":"Test for association with progression","title":"Unlocking single cell spatial omics analyses with scdney","text":"can use colTest function test associations proportions cells region progression status. Time code chunk run: 0.11 seconds Questions 1. results lisaClust used conjunction results spicyR?","code":"# Test if the proportion of each region is associated # with progression status. testRegion <- colTest(   cells,   feature = \"region\",   condition = \"group\",   type = \"ttest\")  testRegion #>          mean in group NP mean in group P tval.t pval adjPval  cluster #> region_5            0.360           0.390  -1.40 0.16    0.45 region_5 #> region_1            0.065           0.044   1.10 0.26    0.45 region_1 #> region_2            0.048           0.033   1.10 0.27    0.45 region_2 #> region_4            0.140           0.120   0.71 0.48    0.60 region_4 #> region_3            0.390           0.410  -0.37 0.71    0.71 region_3"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"statial","dir":"Articles","previous_headings":"Context","what":"Statial","title":"Unlocking single cell spatial omics analyses with scdney","text":"Statial Package","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"spatiomark-continuous-changes-in-marker-expression-associated-with-varying-levels-of-localisation-","dir":"Articles","previous_headings":"Context > Statial","what":"SpatioMark: Continuous changes in marker expression associated with varying levels of localisation.","title":"Unlocking single cell spatial omics analyses with scdney","text":"first step analysing changes calculate spatial proximity (getDistances) cell every cell type. values stored reducedDims slot SingleCellExperiment object names distances. SpatioMark also provides functionality look proximal cell abundance using getAbundance() function, explored within Statial package vignette Time code chunk run: 1.63 seconds can visualise example image, specified image = \"F3\" particular marker interaction cell type localisation. visualise changes, specify two cell types parameters, marker marker parameter (cell-cell-marker interactions). , specify changes marker podoplanin SC localisation EP increases decreases, can observe podoplanin decreases distance dense clump tumour cells increases.  Time code chunk run: 0.43 seconds SpatioMark aims holistically uncover significant relationships looking interactions across images. calcStateChanges() function provided Statial can expanded exact purpose - specifying cell types, marker, image, calcStateChanges() examine significant correlations distance marker expression across entire dataset. Time code chunk run: 1.8 seconds results SpatioMark outputs can converted data.frame matrix, using prepMatrix() function. Note, choice extracting either t-statistic coefficient linear regression can specified using column = \"tval\" parameter, coefficient default extracted parameter. can see SpatioMark, get features significant adjusting FDR. Time code chunk run: 0.16 seconds","code":"cells <- getDistances(cells,   maxDist = 200,   nCores = nCores,   cellType = \"cellType\",   spatialCoords = c(\"x\", \"y\") ) p <- plotStateChanges(   cells = cells,   cellType = \"cellType\",   spatialCoords = c(\"x\", \"y\"),   type = \"distances\",   image = \"F3\",   from = \"SC\",   to = \"EP\",   marker = \"podoplanin\",   size = 1,   shape = 19,   interactive = FALSE,   plotModelFit = FALSE,   method = \"lm\" )  p #> $image #>  #> $scatter state_dist <- calcStateChanges(   cells = cells,   cellType = \"cellType\",   type = \"distances\",   assay = 2,   nCores = nCores,   minCells = 100 )  head(state_dist[state_dist$imageID == \"F3\",], n = 10) #>       imageID primaryCellType otherCellType     marker          coef      tval #> 51810      F3              SC            EP podoplanin -0.0006911103 -16.90036 #> 23703      F3              EP            GC      CXCR3  0.0012103305  15.04988 #> 23704      F3              EP            GC     pSTAT3  0.0012299816  14.79933 #> 51978      F3              SC            GC       PDL2  0.0008802428  13.12601 #> 23669      F3              EP            MC       CCR7  0.0011476888  13.32900 #> 23775      F3              EP        TC_CD8      CXCR3  0.0016741880  12.95156 #> 51981      F3              SC            GC       ICOS  0.0005186181  11.75830 #> 23696      F3              EP            GC      CADM1  0.0011398625  12.18028 #> 11426      F3              EC            GC       CD31  0.0010070252  12.40866 #> 23758      F3              EP            EC       TIM3  0.0033539928  12.05028 #>               pval          fdr #> 51810 4.203881e-59 9.004712e-57 #> 23703 8.041089e-41 8.191646e-39 #> 23704 8.916789e-40 8.712976e-38 #> 51978 1.839014e-37 1.637728e-35 #> 23669 9.360248e-34 6.863845e-32 #> 23775 3.025912e-32 2.085497e-30 #> 51981 1.113579e-30 7.070268e-29 #> 23696 3.239532e-29 1.903862e-27 #> 11426 4.839241e-29 2.825645e-27 #> 23758 1.030900e-28 5.930114e-27 # Preparing outcome vector outcome <- cells$group[!duplicated(cells$imageID)] names(outcome) <- cells$imageID[!duplicated(cells$imageID)]  # Preparing features for Statial distMat <- prepMatrix(state_dist)  distMat <- distMat[names(outcome), ]  # Remove some very small values distMat <- distMat[, colMeans(abs(distMat) > 0.0001) > .8]  survivalResults <- colTest(distMat, outcome, type = \"ttest\")  head(survivalResults) #>                   mean in group NP mean in group P tval.t    pval adjPval #> EC__EC__CD13              -0.00240        -9.6e-04   -3.6 0.00086    0.27 #> SC__SC__VISTA             -0.00470        -1.7e-03   -3.3 0.00190    0.27 #> SC__TC_CD4__CXCR3         -0.00015         8.8e-04   -3.4 0.00230    0.27 #> SC__EP__Ki67              -0.00037        -7.3e-05   -3.2 0.00260    0.27 #> EC__SC__CD68               0.00029        -3.9e-04    3.2 0.00300    0.27 #> SC__BC__DNA1               0.02600        -1.4e-01    3.0 0.00480    0.27 #>                             cluster #> EC__EC__CD13           EC__EC__CD13 #> SC__SC__VISTA         SC__SC__VISTA #> SC__TC_CD4__CXCR3 SC__TC_CD4__CXCR3 #> SC__EP__Ki67           SC__EP__Ki67 #> EC__SC__CD68           EC__SC__CD68 #> SC__BC__DNA1           SC__BC__DNA1"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"kontextual","dir":"Articles","previous_headings":"Context > Statial","what":"Kontextual","title":"Unlocking single cell spatial omics analyses with scdney","text":"Pre-print  Time code chunk run: 0.84 seconds Time code chunk run: 0 seconds save time saved output results . Time code chunk run: 0.01 seconds can use spicyR::spicy test associations Kontextual values progression status. use alternateResult argument. Time code chunk run: 3.95 seconds Questions Compare plot spicyR results previously using signifPlot(spicyTest), Kontextual results compare spicyR? interpretation differences spicyR Kontextual? Use plotKontextual() function visualise relationships (example ), anything strikes ?  Time code chunk run: 0.38 seconds","code":"# Cluster cell type hierarchy hierarchy <- treekoR::getClusterTree(t(assay(cells, \"norm\")),                                      clusters = cells$cellType,                                      hierarchy_method = \"hopach\")   parentList = Statial::getParentPhylo(hierarchy)  # Visualise tree hierarchy$clust_tree |>    plot() # Add parent 4 and 5 parentList$parent_4 = c(parentList$parent_2, parentList$parent_3) parentList$parent_5 = c(parentList$parent_1, \"EC\")  all = unique(cells$cellType)  # Create data frame with all pairwise combinations of cells treeDf = Statial::parentCombinations(all, parentList = parentList) kontext = Statial::Kontextual(   cells = cells,   cellType = \"cellType\",   r = 50,   parentDf = treeDf,   cores = nCores ) load(system.file(\"extdata\", \"kontext.rda\", package = \"scdneySpatialBiocAsia2024\")) # Converting Kontextual result into data matrix kontextMat <- Statial::prepMatrix(kontext)  # Replace NAs with 0 kontextMat[is.na(kontextMat)] <- 0  # Test association with outcome kontextOutcome = spicyR::spicy(   cells = cells,   alternateResult = kontextMat,   condition = \"group\",   BPPARAM = BPPARAM )  # Plot results signifPlot(kontextOutcome) spicyR::signifPlot(spicyTest) relationship = \"TC_CD4__EC__parent_5\" image = \"G4\"  kontext |>    filter(test == relationship) #>    imageID                 test     original  kontextual  r inhomL #> 1       A2 TC_CD4__EC__parent_5   7.68160860   6.5066053 50  FALSE #> 2       A3 TC_CD4__EC__parent_5   2.23350953   3.4434658 50  FALSE #> 3       A4 TC_CD4__EC__parent_5  -0.08701334   6.3304807 50  FALSE #> 4       A5 TC_CD4__EC__parent_5  -0.57639962   4.5311090 50  FALSE #> 5       A6 TC_CD4__EC__parent_5  10.02403012   7.5150350 50  FALSE #> 6       B1 TC_CD4__EC__parent_5  10.87585261  14.2134530 50  FALSE #> 7       B2 TC_CD4__EC__parent_5   5.06002008   5.9931607 50  FALSE #> 8      B21 TC_CD4__EC__parent_5  -0.39959694   0.1112766 50  FALSE #> 9       B3 TC_CD4__EC__parent_5   5.23542623   8.0275823 50  FALSE #> 10      B4 TC_CD4__EC__parent_5  -0.66071472  -0.1844264 50  FALSE #> 11      B6 TC_CD4__EC__parent_5   9.16587133   8.8867521 50  FALSE #> 12      C1 TC_CD4__EC__parent_5   9.40908266   8.2981051 50  FALSE #> 13      C2 TC_CD4__EC__parent_5  11.04803399   2.7263300 50  FALSE #> 14      C3 TC_CD4__EC__parent_5   9.22058958   9.5992764 50  FALSE #> 15      C4 TC_CD4__EC__parent_5  13.43380132   5.4622749 50  FALSE #> 16      D2 TC_CD4__EC__parent_5  10.12907090  12.3327148 50  FALSE #> 17      D3 TC_CD4__EC__parent_5  42.43221968  19.7863298 50  FALSE #> 18      D4 TC_CD4__EC__parent_5   6.50868799   5.7006945 50  FALSE #> 19      D5 TC_CD4__EC__parent_5   9.78058152   8.1404195 50  FALSE #> 20      D6 TC_CD4__EC__parent_5   4.28348294   7.1094799 50  FALSE #> 21      E1 TC_CD4__EC__parent_5  14.76511580   2.7278164 50  FALSE #> 22      F3 TC_CD4__EC__parent_5 -14.09044015 -17.7783051 50  FALSE #> 23      F4 TC_CD4__EC__parent_5 -15.53759618 -18.9689276 50  FALSE #> 24      F5 TC_CD4__EC__parent_5 -12.86245147 -14.6367869 50  FALSE #> 25      G4 TC_CD4__EC__parent_5  -2.39530472   2.3617033 50  FALSE #> 26      G5 TC_CD4__EC__parent_5   5.51623888  10.5583310 50  FALSE #> 27      G6 TC_CD4__EC__parent_5   4.33164604   4.7053925 50  FALSE #> 28      H1 TC_CD4__EC__parent_5   1.94802803   7.4361377 50  FALSE #> 29      H2 TC_CD4__EC__parent_5  13.35930713  13.0588006 50  FALSE #> 30      H3 TC_CD4__EC__parent_5   1.34443428   5.0182459 50  FALSE #> 31      H4 TC_CD4__EC__parent_5   7.54306921   3.3522477 50  FALSE #> 32      H5 TC_CD4__EC__parent_5  -5.21413323  -0.9181290 50  FALSE #> 33      H6 TC_CD4__EC__parent_5   1.66543198   5.6357928 50  FALSE #> 34      I1 TC_CD4__EC__parent_5   2.68026706   9.4393784 50  FALSE #> 35      I2 TC_CD4__EC__parent_5   9.77724059  16.0998082 50  FALSE #> 36      I3 TC_CD4__EC__parent_5  33.93318280   7.6225714 50  FALSE #> 37      I4 TC_CD4__EC__parent_5  32.63243351  19.1496354 50  FALSE #> 38      I5 TC_CD4__EC__parent_5  25.11060806   9.8891406 50  FALSE #> 39      J3 TC_CD4__EC__parent_5  23.47187850  23.5485701 50  FALSE #> 40      J4 TC_CD4__EC__parent_5  23.69363791  22.2011439 50  FALSE #> 41      J5 TC_CD4__EC__parent_5   6.56434930   5.9825165 50  FALSE #> 42      J6 TC_CD4__EC__parent_5   2.98025405   2.9704760 50  FALSE #> 43      K1 TC_CD4__EC__parent_5  -1.60932447   0.2013516 50  FALSE #> 44      K2 TC_CD4__EC__parent_5   4.00813298   4.2639758 50  FALSE # Function from inst/extdata/utils.R file plotKontextual(relationship, imageChoose = image)"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"classifyr-patient-classification","dir":"Articles","previous_headings":"","what":"ClassifyR: Patient classification","title":"Unlocking single cell spatial omics analyses with scdney","text":"ClassifyR Package Journal article ClassifyR package formalises convenient framework evaluating classification R. provide functionality easily include four key modelling stages; Data transformation, feature selection, classifier training prediction; cross-validation loop. use crossValidate function perform 50 repeats 5-fold cross-validation evaluate performance model (classifier) feature selection (selectionMethod) applied five quantifications IMC data; 1) Cell type proportions 2) Cell type localisation spicyR 3) Region proportions lisaClust 4) Cell type localisation reference parent cell type Kontextual 5) Cell changes response proximal changes SpatioMark Time code chunk run: 0.04 seconds saved data list outcomes convenience. Time code chunk run: 0.01 seconds Time code chunk run: 0 seconds saved results convenience. Time code chunk run: 0.53 seconds","code":"# Create list to store data.frames data <- list()  # Add proportions of each cell type in each image data[[\"Proportions\"]] <- getProp(cells, \"cellType\")  # Add pair-wise associations spicyMat <- spicyR::bind(spicyTest) spicyMat[is.na(spicyMat)] <- 0 spicyMat <- spicyMat |>   select(!condition) |>   tibble::column_to_rownames(\"imageID\")  data[[\"SpicyR\"]] <- spicyMat   # Add proportions of each region in each image to the list of dataframes. data[[\"LisaClust\"]] <- getProp(cells, \"region\")   # Add SpatioMark features data[[\"SpatioMark\"]] <- distMat  # Add Kontextual features data[[\"Kontextual\"]] <- kontextMat load(system.file(\"extdata\", \"data.rda\", package = \"scdneySpatialBiocAsia2024\")) # Set seed set.seed(51773)  # Perform 5-fold cross-validation with 50 repeats. cv <- ClassifyR::crossValidate(   measurements = data,   outcome = outcome,   selectionMethod = \"t-test\",   classifier = \"LASSOGLM\",   nFolds = 5,   nFeatures = 20,   nRepeats = 50,   nCores = nCores ) load(system.file(\"extdata\", \"cv.rda\", package = \"scdneySpatialBiocAsia2024\"))"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/articles/scdneySpatial.html","id":"visualise-cross-validated-prediction-performance","dir":"Articles","previous_headings":"ClassifyR: Patient classification","what":"Visualise cross-validated prediction performance","title":"Unlocking single cell spatial omics analyses with scdney","text":"use performancePlot function assess AUC repeat 5-fold cross-validation. Time code chunk run: 3.73 seconds Questions Run following chunk code, plot telling us? different methods perform differently different samples? Knowing , might improve model? Time code chunk run: 0.4 seconds following code chunk demonstrates might use information multiple matrices perform classification. Time code chunk run: 0 seconds Time code chunk run: 0.01 seconds Time code chunk run: 0.1 seconds","code":"performancePlot(   cv,   metric = \"AUC\",   characteristicsList = list(x = \"Assay Name\"),   orderingList = list(\"Assay Name\" = c(\"Proportions\", \"SpicyR\", \"LisaClust\", \"Kontextual\", \"SpatioMark\")) ) samplesMetricMap(cv) |>    plot() # DO NOT RUN multiCV <- ClassifyR::crossValidate(   measurements = data,   outcome = outcome,   selectionMethod = \"t-test\",   classifier = \"LASSOGLM\",   nFolds = 5,   nFeatures = 20,   nRepeats = 50,   multiViewMethod = \"merge\",   nCores = nCores )  plot = performancePlot(   multiCV,   metric = \"AUC\",   characteristicsList = list(x = \"Assay Name\"), ) knitr::include_graphics(system.file(\"images\", \"plot.png\", package = \"scdneySpatialBiocAsia2024\")) sessionInfo() #> R version 4.4.0 (2024-04-24) #> Platform: aarch64-apple-darwin20 #> Running under: macOS 15.0.1 #>  #> Matrix products: default #> BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib  #> LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0 #>  #> locale: #> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>  #> time zone: Australia/Sydney #> tzcode source: internal #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] scdneySpatialBiocAsia2024_2.0.1 knitr_1.48                      #>  [3] glmnet_4.1-8                    Matrix_1.7-1                    #>  [5] scater_1.34.0                   scuttle_1.15.4                  #>  [7] cytomapper_1.18.0               EBImage_4.48.0                  #>  [9] lubridate_1.9.3                 forcats_1.0.0                   #> [11] stringr_1.5.1                   purrr_1.0.2                     #> [13] readr_2.1.5                     tibble_3.2.1                    #> [15] tidyverse_2.0.0                 ggplot2_3.5.1                   #> [17] ttservice_0.4.1                 tidyr_1.3.1                     #> [19] dplyr_1.1.4                     tidySingleCellExperiment_1.16.0 #> [21] ClassifyR_3.10.0                survival_3.7-0                  #> [23] BiocParallel_1.40.0             MultiAssayExperiment_1.32.0     #> [25] generics_0.1.3                  Statial_1.8.0                   #> [27] spicyR_1.18.0                   lisaClust_1.14.0                #> [29] FuseSOM_1.8.0                   simpleSeg_1.8.0                 #> [31] SpatialDatasets_1.4.0           SpatialExperiment_1.16.0        #> [33] SingleCellExperiment_1.28.0     SummarizedExperiment_1.36.0     #> [35] GenomicRanges_1.58.0            GenomeInfoDb_1.42.0             #> [37] IRanges_2.40.0                  S4Vectors_0.44.0                #> [39] MatrixGenerics_1.18.0           matrixStats_1.4.1               #> [41] ExperimentHub_2.14.0            AnnotationHub_3.14.0            #> [43] BiocFileCache_2.14.0            dbplyr_2.5.0                    #> [45] Biobase_2.66.0                  BiocGenerics_0.52.0             #>  #> loaded via a namespace (and not attached): #>   [1] tiff_0.1-12                 FCPS_1.3.4                  #>   [3] nnet_7.3-19                 goftest_1.2-3               #>   [5] Biostrings_2.74.0           HDF5Array_1.34.0            #>   [7] TH.data_1.1-2               vctrs_0.6.5                 #>   [9] spatstat.random_3.3-2       digest_0.6.37               #>  [11] png_0.1-8                   shape_1.4.6.1               #>  [13] proxy_0.4-27                ggrepel_0.9.6               #>  [15] deldir_2.0-4                permute_0.9-7               #>  [17] magick_2.8.5                MASS_7.3-61                 #>  [19] pkgdown_2.1.1               reshape2_1.4.4              #>  [21] httpuv_1.6.15               foreach_1.5.2               #>  [23] withr_3.0.2                 ggfun_0.1.7                 #>  [25] psych_2.4.6.26              xfun_0.49                   #>  [27] ggpubr_0.6.0                ellipsis_0.3.2              #>  [29] memoise_2.0.1               ggbeeswarm_0.7.2            #>  [31] RProtoBufLib_2.18.0         diptest_0.77-1              #>  [33] princurve_2.1.6             systemfonts_1.1.0           #>  [35] tidytree_0.4.6              zoo_1.8-12                  #>  [37] GlobalOptions_0.1.2         ragg_1.3.3                  #>  [39] V8_6.0.0                    DEoptimR_1.1-3              #>  [41] prabclus_2.3-4              Formula_1.2-5               #>  [43] KEGGREST_1.46.0             promises_1.3.0              #>  [45] httr_1.4.7                  rstatix_0.7.2               #>  [47] rhdf5filters_1.18.0         fpc_2.2-13                  #>  [49] rhdf5_2.50.0                rstudioapi_0.17.1           #>  [51] UCSC.utils_1.2.0            concaveman_1.1.0            #>  [53] curl_6.0.0                  zlibbioc_1.52.0             #>  [55] ScaledMatrix_1.14.0         analogue_0.17-7             #>  [57] polyclip_1.10-7             GenomeInfoDbData_1.2.13     #>  [59] SparseArray_1.6.0           fftwtools_0.9-11            #>  [61] doParallel_1.0.17           xtable_1.8-4                #>  [63] desc_1.4.3                  evaluate_1.0.1              #>  [65] S4Arrays_1.6.0              hms_1.1.3                   #>  [67] irlba_2.3.5.1               colorspace_2.1-1            #>  [69] filelock_1.0.3              spatstat.data_3.1-2         #>  [71] flexmix_2.3-19              magrittr_2.0.3              #>  [73] ggtree_3.14.0               later_1.3.2                 #>  [75] viridis_0.6.5               modeltools_0.2-23           #>  [77] lattice_0.22-6              robustbase_0.99-4-1         #>  [79] spatstat.geom_3.3-3         XML_3.99-0.17               #>  [81] cowplot_1.1.3               RcppAnnoy_0.0.22            #>  [83] ggupset_0.4.0               class_7.3-22                #>  [85] svgPanZoom_0.3.4            pillar_1.9.0                #>  [87] nlme_3.1-166                iterators_1.0.14            #>  [89] compiler_4.4.0              beachmat_2.22.0             #>  [91] stringi_1.8.4               tensor_1.5                  #>  [93] minqa_1.2.8                 plyr_1.8.9                  #>  [95] treekoR_1.14.0              crayon_1.5.3                #>  [97] abind_1.4-8                 gridGraphics_0.5-1          #>  [99] locfit_1.5-9.10             sp_2.1-4                    #> [101] bit_4.5.0                   terra_1.7-78                #> [103] sandwich_3.1-1              multcomp_1.4-26             #> [105] fastcluster_1.2.6           codetools_0.2-20            #> [107] textshaping_0.4.0           BiocSingular_1.22.0         #> [109] bslib_0.8.0                 coop_0.6-3                  #> [111] GetoptLong_1.0.5            plotly_4.10.4               #> [113] mime_0.12                   splines_4.4.0               #> [115] circlize_0.4.16             Rcpp_1.0.13-1               #> [117] profileModel_0.6.1          blob_1.2.4                  #> [119] utf8_1.2.4                  clue_0.3-65                 #> [121] BiocVersion_3.20.0          lme4_1.1-35.5               #> [123] fs_1.6.5                    nnls_1.6                    #> [125] ggsignif_0.6.4              ggplotify_0.1.2             #> [127] scam_1.2-17                 statmod_1.5.0               #> [129] tzdb_0.4.0                  svglite_2.1.3               #> [131] tweenr_2.0.3                pkgconfig_2.0.3             #> [133] pheatmap_1.0.12             tools_4.4.0                 #> [135] cachem_1.1.0                RSQLite_2.3.7               #> [137] viridisLite_0.4.2           DBI_1.2.3                   #> [139] numDeriv_2016.8-1.1         fastmap_1.2.0               #> [141] rmarkdown_2.29              scales_1.3.0                #> [143] grid_4.4.0                  shinydashboard_0.7.2        #> [145] broom_1.0.7                 sass_0.4.9                  #> [147] patchwork_1.3.0             brglm_0.7.2                 #> [149] BiocManager_1.30.25         carData_3.0-5               #> [151] farver_2.1.2                mgcv_1.9-1                  #> [153] yaml_2.3.10                 ggthemes_5.1.0              #> [155] cli_3.6.3                   hopach_2.66.0               #> [157] lifecycle_1.0.4             uwot_0.2.2                  #> [159] mvtnorm_1.3-2               kernlab_0.9-33              #> [161] backports_1.5.0             cytolib_2.18.0              #> [163] timechange_0.3.0            gtable_0.3.6                #> [165] rjson_0.2.23                ape_5.8                     #> [167] parallel_4.4.0              limma_3.62.1                #> [169] edgeR_4.3.19                jsonlite_1.8.9              #> [171] bitops_1.0-9                bit64_4.5.2                 #> [173] Rtsne_0.17                  FlowSOM_2.14.0              #> [175] yulab.utils_0.1.7           vegan_2.6-8                 #> [177] spatstat.utils_3.1-1        BiocNeighbors_2.0.0         #> [179] ranger_0.16.0               flowCore_2.17.0             #> [181] bdsmatrix_1.3-7             jquerylib_0.1.4             #> [183] highr_0.11                  spatstat.univar_3.1-1       #> [185] lazyeval_0.2.2              ConsensusClusterPlus_1.70.0 #> [187] shiny_1.9.1                 diffcyt_1.26.0              #> [189] htmltools_0.5.8.1           rappdirs_0.3.3              #> [191] glue_1.8.0                  XVector_0.46.0              #> [193] RCurl_1.98-1.16             treeio_1.30.0               #> [195] mclust_6.1.1                mnormt_2.1.1                #> [197] coxme_2.2-22                jpeg_0.1-10                 #> [199] gridExtra_2.3               boot_1.3-31                 #> [201] igraph_2.1.1                R6_2.5.1                    #> [203] ggiraph_0.8.10              labeling_0.4.3              #> [205] ggh4x_0.2.8                 cluster_2.1.6               #> [207] Rhdf5lib_1.28.0             aplot_0.2.3                 #> [209] nloptr_2.1.1                DelayedArray_0.32.0         #> [211] tidyselect_1.2.1            vipor_0.4.7                 #> [213] ggforce_0.4.2               raster_3.6-30               #> [215] car_3.1-3                   AnnotationDbi_1.68.0        #> [217] rsvd_1.0.5                  munsell_0.5.1               #> [219] DataVisualizations_1.3.2    data.table_1.16.2           #> [221] ComplexHeatmap_2.22.0       htmlwidgets_1.6.4           #> [223] RColorBrewer_1.1-3          rlang_1.1.4                 #> [225] spatstat.sparse_3.1-0       spatstat.explore_3.3-3      #> [227] colorRamps_2.3.4            uuid_1.2-1                  #> [229] lmerTest_3.1-3              ggnewscale_0.5.0            #> [231] fansi_1.0.6                 beeswarm_0.4.0"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Farhan Ameen. Author, maintainer. Alex Qin. Author. Shreya Rao. Author. Ellis Patrick. Author.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ameen F, Qin , Rao S, Patrick E (2024). scdneySpatialBiocAsia2024: Unlocking single cell spatial omics analyses scdney. R package version 2.0.1, https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/.","code":"@Manual{,   title = {scdneySpatialBiocAsia2024: Unlocking single cell spatial omics analyses with scdney},   author = {Farhan Ameen and Alex Qin and Shreya Rao and Ellis Patrick},   year = {2024},   note = {R package version 2.0.1},   url = {https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/}, }"},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"ScdneySpatial","text":"Understanding interplay different types cells immediate environment critical understanding mechanisms cells function context human diseases. Recent advances high dimensional situ cytometry technologies fundamentally revolutionized ability observe complex cellular relationships providing unprecedented characterisation cellular heterogeneity tissue environment.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/index.html","id":"description","dir":"","previous_headings":"","what":"Description","title":"ScdneySpatial","text":"tutorial introduce analytical framework analysing data high dimensional spatial omics technologies , CODEX, CycIF, IMC High Definition Spatial Transcriptomics. framework makes use functionality Bioconductor packages simpleSeg, FuseSOM, spicyR, listClust, Statial ClassifyR. end tutorial attendees able implement assess key steps spatial analysis pipeline including cell segmentation, feature normalisation, cell type identification, microenvironment cell-state characterisation, spatial hypothesis testing patient classification. Understanding key steps provide attendees core skills needed interrogate comprehensive spatial information generated exciting new technologies.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/index.html","id":"pre-requisites","dir":"","previous_headings":"Description","what":"Pre-requisites","title":"ScdneySpatial","text":"expected students : basic knowledge R syntax, familiarity SingleCellExperiment /SpatialExperiment objects, workshop provide -depth description cell-resolution spatial omics technologies.","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/index.html","id":"time-outline","dir":"","previous_headings":"Description","what":"Time outline","title":"ScdneySpatial","text":"expected timing workshop:","code":""},{"path":"https://sydneybiox.github.io/scdneySpatial_BiocAsia2024/index.html","id":"learning-objectives","dir":"","previous_headings":"Description","what":"Learning objectives","title":"ScdneySpatial","text":"Understand visualise spatial omics datasets. Identify key biological questions can addressed technologies spatial analysis. Understand key analytical steps involved spatial omics analysis, perform steps using R. Evaluate performance data normalisation cell segmentation. Understand generate individual feature representations spatial omics data. Develop appreciation assess performance classification models. Perform disease outcome prediction using feature representation robust classification framework.","code":""}]
